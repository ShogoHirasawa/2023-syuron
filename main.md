#タイトル:

## 概要

本研究では洪水被害発生時に通信インフラがダウンした状況でも、スマートフォンを媒介としたデジタルハザードマップを通じて、危険地帯を把握するシステムの可能性について検討する。スマートフォンをインターフェイスとしたオフライン環境下で利用できる地図サービスとして、「Google Maps」、「Maps.me」、「あかりマップ」のような事例はみられるものの、App Store や Google Play といったアプリストアからの事前ダウンロードなしにオフラインで活用できる地図サービスおよび、ハザードマップサービスの事例は見られない。そこで、Raspberry Pi 4 を基調とした持ち運び可能な地図配信サーバー及び、ハザードマップに最適化させた地図データ、地図デザインの開発を行い、事前ダウンロードなしに通信インフラがダウンした状況でハザードマップにアクセスし、利用者が洪水災害時において危険地帯を把握できるかを検討する。この実装例を通じて、オフライン環境下でも地図情報にアクセスし、利用者が適切な避難ルートを検討する支援を行うことを可能とする。

## 1. 序論

### 1.1. 本研究の背景

近年、自然災害が多発するなかで、市民の避難を適切にかつ安全に実施することは極めて重要な点である。特に洪水災害においては、2005 年の水防法改正により浸水想定区域の指定を受けた市町村は市民に対して、洪水予測の公表が義務付けられた。また、2005 年から 2009 年に洪水ハザードマップ作成に対する国庫補助制度が策定されたことを契機にハザードマップの普及は進んだ（榎村,2012）。各自治体の Web ページにおいて pdf データでの提供や紙のハザードマップの配布のみならず、国土地理院が国土交通省水管理・国土保全局と協力して提供する「国土交通省ハザードマップポータルサイト」をはじめとした Web 上でインタラクティブに災害情報を伝えるハザードマップも存在する（泉谷,2020）。Web 媒体でハザードマップを閲覧できるようになることで、各レイヤ情報の表示・非表示が可能となり、多くの情報を盛り込んでもインターフェイスが雑多で見づらくならない、ピンチイン・アウトが可能となり詳細な地図情報を表示できるようになったなど、pdf、紙媒体でのハザードマップの表現の限界を克服している。

### 1.1.1 ハザードマップの現状

一方で、洪水被害が発生した際にはインターネットが断絶する事例が報告されている。2020 年 7 月 4 日大雨の影響により熊本県球磨川が氾濫するなどして、死者・行方不明者が 69 人がでる被害が発生した（NHK,2023）。この大雨の影響により、停電、土砂崩れ等による回線が断絶し、22 市町村でインターネットの接続が困難となった（総務省,2020）。また、回線が断絶するといった直接的な被害のみならず、大雨や洪水によって交通インフラが損傷し、インターネットサービスプロバイダー等の通信に関わる事業者の業務が中断されることで、インターネットサービスの提供に支障をきたすことを指摘する研究報告も上がっている（Fekete and Alexander,2019）。加えて、災害時には通信が輻輳し、インターネットに接続が難しくなる状況も発生する（増田,2012）。オフライン環境下では、従来の紙媒体での洪水ハザードマップの利用が想定されるが、避難所や浸水域等の情報を 1 枚の紙に集約しなくてはいけない都合上、インターフェイスが雑多になってしまうことや、配布されて時間が経過することによってハザードマップを紛失してしまう住民が存在するなどの課題がある（方田他,1999）（榎村,2012） 。洪水ハザードマップの役割の一つに発災時において市民が避難をする際のマニュアルとして機能することが挙げられる（片田他,2004）。「Google Maps」や「Maps．me」等のオフライン環境下であっても、スマートフォンで地図を閲覧できる機能を有したサービスはあるが、浸水深や浸水域の情報、避難所の位置情報、標高情報といった情報は有していないため、避難ルートを検討することが難しい。

### 1.2. 研究の目的

以上の背景を踏まえ、本研究の目的は洪水被害発生時に通信インフラがダウンした状況でも、スマートフォンのブラウザアプリケーションを通じて避難ルートを検討するための情報が掲載された洪水ハザードマップを閲覧可能とするシステムの提案することである。

## 2. 先行研究・先行事例

### 2.1. 既存の激甚災害化における通信インフラ環境
- 過去の洪水災害でオフライン環境であるがゆえにどのような問題が起きたか
  熊本地震で停電が発生したことを述べる。カスケード効果について触れる。
  ### 2.2. オフライン地図の先行研究/先行事例
- 先行研究/先行事例で解決出来ていない課題点はどこか
  あかりマップのベンダーロックインについてと動くハザードマップ等の Web 上のハザードマップがオンライン環境下でしか稼働しないことを述べる。
  ### 2.3. ハザードマップに関する先行研究
- ハザードマップがなぜ必要なのか。どういった機能を有しているのか
  ハザードマップの定義。どの災害ステータスで使われるものなのか。減災、防災のどちらの面で機能するのかを述べる。
- 現状のハザードマップに足りていない情報について（標高データについて触れる）
  徒歩での避難の際、洪水被害の際は高い場所に避難することが求められるが、高さ情報が直感的にわかるハザードマップは少ない。どの時点で活用できるマップなのかを明示する。
- 紙地図で配布する問題点について
  広域にすればするほど詳細が見えづらい地図になる。耐水紙でないハザードマップが多いこと。
- 現行のハザードマップの掲載情報にかかる問題点について
  情報過多で見えづらい地図になっている。
- 浸水域はあくまで特定の状況下での予想でしかないので、過信は禁物。
  時と場合に応じて、適切な避難が求められる。

## 3. 提案手法

### 3.1. 関連研究を踏まえてどのような機能が必要とされるのか

#### 3.1.1. オフライン環境下での稼働について

本節ではどのように、オフライン環境下でのハザードマップを配信するシステムを構築したかについて述べる。本研究では、低コストでありながら高い汎用性と拡張性を持つマイクロコンピューターであるラズベリーパイを用いた地図サーバーの構築を試みた。ラズベリーパイは、教育や研究、趣味のプロジェクトなど、多岐にわたる分野で使用されているマイクロコンピューターである。ラズベリーパイは、そのコンパクトなサイズにも関わらず、高性能の処理能力を有しており、全国津々浦々どこでも手軽に入手可能である。ラズベリーパイをアクセスポイントとして機能させることにより、ラズベリーパイを基点としてイントラネットを構築し、オフライン環境下でもスマートフォンを通じてアクセス可能な地図サーバーとしての役割を果たすよう設定した。アクセスポイントとは、ワイヤレスネットワークにおけるデバイス間の通信を仲介する装置であり、この場合ではラズベリーパイがその機能を担う。これにより、オフライン状態であっても、スマートフォンやタブレットなどのデバイスから地図情報にアクセスできる体制を構築した。システムのホスティングにあたり、Apache2、hostapd、dnsmasq と呼ばれる三つの主要なオープンソースソフトウェアパッケージを採用した。Apache2 は世界で最も普及している Web サーバーソフトウェアの一つであり、ユーザーリクエストに応じて Web ページや画像、その他のデータを配信する機能をラズベリーパイに提供する。hostapd は無線 LAN デバイスをアクセスポイントとして機能させるためのソフトウェアであり、この研究ではラズベリーパイに接続されるスマートフォン等の各デバイスの管理を担う。dnsmasq は、ネットワーク上のデバイスに対して DNS サーバーの役割を果たし、動的に IP アドレスを割り当てる機能を提供する。これらのパッケージを組み合わせることで、ラズベリーパイは単なる Web サーバーを超え、総合的な通信ソリューションとして機能し、結果として災害時においても避難者のスマートフォンを通じて地図データを提供することが可能になった。避難者はラズベリーパイに付随している QR コードをスマートフォンのカメラでスキャンすることによって、ラズベリーパイと接続し、ハザードマップの閲覧が可能となる。

#### 3.1.2. 紙地図との違いについて

本節では、従来の紙地図に基づいたハザードマップの限界点を指摘し、提案システムがこれらの問題をどのように解決するかについて詳述する。多くの自治体において、ハザードマップは A4 サイズの紙媒体で配布されることが一般的であり、市区町村全体をこのサイズの紙に収める必要がある。広い地域を一枚の紙に収めることで、道路名や地物の名称といった細部の情報を省略せざる負えなくなる。さらに、紙地図ではレイヤーという概念が存在しないため、一枚の地図に複数の情報を盛り込む必要がでてくる。これには浸水域、浸水速度、標高、避難ルート、避難所の位置など、多岐にわたる情報が含まれる。地名や山の名前といった追加情報を含めると、インターフェースが複雑になり、利用者にとっては情報過多となりがちである。また、災害発生時に雨が降っていた場合に紙地図であると濡れて利用が難しくなる場合も想定される。一方で、本研究で開発した Web ベースの地図システムでは、デジタルの利点を活かしピンチイン・ピンチアウト操作によるズームが可能である。これにより、広域の表示と同時に詳細情報の表示が可能となり、従来のハザードマップが抱える問題を克服している。また、オープンソースの地図ライブラリである MapLibre GL JS を用いることで、異なる種類の情報をレイヤーとして重ね合わせ、表示・非表示をユーザーが容易に切り替えることができる。これにより、浸水域、避難ルート、避難所といった重要な情報を、視認性を損なうことなく、明瞭に表示することが可能となり、さらには凡例も表示可能である。インターフェースの混雑を避けるために、表示・非表示の切り替えは単なるクリックまたはタップ操作で行えるように実装した。また、2023 年時点での主要な Apple、Samsung、Huawei といったスマートフォンブランドの多くのモデルは、IP67 または IP68 の防水等級を有している。これは、一定の深さ（通常は 1 メートルから 1.5 メートル）の水中に 30 分間程度浸しても機能するレベルの防水性能を有していることを意味している。本システムはスマートフォンからのアクセスを前提としているため、紙地図よりも防水体制が高い状態で、ハザードマップを閲覧することが可能となる。本システムはデジタル地図の利点を生かし、紙地図に固有の制限を克服し、情報の過不足のトレードオフを解決することに成功している。

#### 3.1.3. ベンダーロックインの回避

本節では、オフライン Web 地図サービスにおけるベンダーロックインの問題に深く掘り下げる。ベンダーロックインは、消費者やユーザーが特定のベンダーの技術やサービスに縛られ、他の代替品への移行が技術的、経済的な理由により困難になる現象のことを指す。この問題は、特に災害時のような緊急事態において、地理情報のアクセシビリティという点で重大な障害となり得る。例えば、洪水や地震などの自然災害が発生した際には、インターネットの基盤が脆弱となり、オフラインでの情報アクセスが求められる。 従来のオフライン対応の Web 地図サービスは、特定のプラットフォームやデバイスに限定されることが多く、これがベンダーロックインを助長する要因となっていた。例えば、iOS 用に設計されたアプリケーションは Android デバイスでは使用できず、その逆もまた然りである。このような状況は、ユーザーが災害時に必要な情報にアクセスする能力を制限し、その結果として安全性が低下することに繋がりかねない。この問題に対処するために、本研究ではプラットフォームに依存しない解決策を模索している。具体的には、スマートフォンやタブレットなどのデバイスに内蔵されたカメラを利用して QR コードを読み取り、これによって特定の Web 地図サービスに直接アクセスする方法を採用した。このアプローチは、Firefox、Chrome、Safari といった主要なウェブブラウザに対応しており、ユーザーがどのような OS を使用していても、どのようなスマートフォンを持っていても、同様のアクセス体験を提供する。これにより、災害時においても地図情報へのアクセスを保証し、オフラインでの情報共有を可能にする。さらに、ベンダーロックインの問題に対する実用的な回避策として機能し、災害リスク管理における地図サービスの利用を一層促進することが期待される。このように、ベンダーロックインを回避することは、技術の選択肢を広げるだけでなく、災害時の対応力を高めることにも繋げることができる。

#### 3.1.5. 標高情報の可視化

本研究では MapLibre GL JS を用いた標高情報の 3D 表示を行った。標高情報は洪水被害発生時、地形の標高や傾斜が安全な避難行動に直接関連するため、これらの情報を直感的かつ明瞭に伝える方法の開発が求められている。従来のハザードマップでは、標高情報が等高線等によって表現されることが多いが、この表現方法は一般市民にとって理解しづらいという課題があった。特に、地図上での低地と高地、急傾斜地を直感的に識別することは困難であり、実際の避難行動において適切な情報提供がなされていない問題点がある。本研究では、ウェブベースの地図サーバーに 3D 地図機能を導入し、標高や傾斜の情報を視覚的に捉えやすい形で表現することにより、ユーザーが低地や高地、傾斜地を容易に識別できるようなインターフェイスを開発した。3D 表示により、等高線だけでは把握しづらい地形の起伏や傾斜度を、ユーザーが直感的に理解できるようになる。従来の 2D 地図による表示では実現できなかった、地形の微細な変化を視覚的に捉えることが可能となった。実験当初はヒルシェード（陰影起伏図）機能を利用した高度情報の表示を行っていた。ヒルシェードは、太陽の位置を仮定し、地形による陰影を表現することで起伏を視覚化する手法である。しかし、実証実験および指導教員のフィードバックから地図を日常的に利用しないユーザーにとって理解しづらいということがわかった。このフィードバックを基に、より直感的な理解を促進するため 3D 機能へと移行した。国土地理院が提供する高精度な標高データを利用することで、3D 地図上での地形表現は一層鮮明で正確なものとなり、ユーザーが現実の地形に即した情報を得られるようになった。これにより、日常的に 2D 地図を使用することがない人々であっても、3D 地図を通じて直感的に地形を把握できるようになった。

#### 3.1.6. ベースマップの配色

本研究では、ハザードマップにおける情報の視認性を高めるために、ベースマップの配色について検討を重ねた。具体的には、モノクロを基調とした配色スキームを採用し、その効果を評価した。モノクロとは、文字通り「一色」を意味し、この文脈では黒、白、灰色のみを使用する配色方法である。モノクロ配色は、視覚的なノイズを減少させ、必要な情報のみを際立たせる。当初はオープンストリートマップ（OpenStreetMap, OSM）における標準的な地図スタイルを使用したハザードマップを構築していたが、重要な情報とそうでない情報との区別が困難であったという実際のユーザーフィードバックがあった。オープンストリートマップは、世界中の地図データを提供する無料のウェブサービスであり、その柔軟性と拡張性から広く利用されているが、デフォルトのスタイルは多様な情報を網羅しているため、特定の用途には適さないことがある。そこで本研究では、ハザードマップの利便性を向上させるために、ベースマップの配色をモノクロに刷新し、避難所の情報や浸水域、浸水深度の情報といった、避難の際に重要となる情報をより際立たせることができるようにした。

#### 3.1.7. ポップアップ表示による避難時注意点の訴求

ハザードマップの役割の一つに、避難時に適切な避難行動を促すことが挙げられる。避難時に留意すべき点や避難ルートについての知識は、防災訓練を受けることによって身につけることが一般的である。しかし、防災訓練を体験してから時間が経過することで、避難時に関する知識は忘却されることは先行研究により指摘されている。このことから、ハザードマップは避難に関する知識が無いまたは乏しい人でも、災害時における危険地帯や避難行動を促す必要がある。文京区が公開している洪水ハザードマップでは、これらの情報がハザードマップの上部に表示されていた。掲載されている文章には、表示している浸水域と浸水深の説明のみされており、避難時に避けるべき箇所の警告がなされていない。これを踏まえ本研究では、国土交通省と気象庁が発信している洪水時の危険地帯をもとに、低地と傾斜地を危険地と定義し、その警告文を以下の図のように掲示した。警告文はタップすることで表示・非表示を切り替えられるように設定した。

## 4. 実験・検証

### 4.1. オフライン環境の構築

### 4.2. 接続試験

       #### 4.2.1. 通信速度テスト
       ページがレンダリングされるまでの速度、通信量の測定を行い、閾値値を満たすものかの検証

       #### 4.2.2. 消費電力の調査

ラズパイにスマホを接続した状態で、どの程度の消費電力かを定量的に計算し、稼働可能時間を推定する。

### 4.3. 避難ルートに関するユーザビリティ評価

       #### 4.3.1. 検証方法の説明
       #### 4.3.2 被験者の属性
       #### 4.3.2. 調査結果

## 5. 結論

### 5.1. 研究の成果

### 5.2. 今後の課題と展望

## 6. 謝辞

## 7. 参考文献
